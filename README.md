# API документация: Управление чатами

## Описание
Этот API позволяет управлять чатами между пользователями. Включает создание приглашений, принятие приглашений и получение информации о чатах.

## Стек технологий
- **FastAPI** — веб-фреймворк для разработки API.
- **SQLAlchemy** — ORM для работы с базой данных.

---

## Эндпоинты

### 1. **POST `/create_chat`**
**Описание**: Создает новый чат между двумя пользователями.

**Тело запроса**:
```json
{
  "user_1": "string",    // Отправитель приглашения
  "user_2": "string",    // Получатель приглашения
  "user_1_secret": "string" // Секретный ключ отправителя
}
```

**Ответ**:
```json
{
  "id": 1,
  "user_1": "user1",
  "user_2": "user2",
  "user_1_secret": "secret1",
  "user_2_secret": null,
  "active": false
}
```

---

### 2. **GET `/invited/{user_2}`**
**Описание**: Получает список непринятых приглашений для указанного пользователя.

**Параметры пути**:
- `user_2` (str): Имя пользователя, для которого ищутся приглашения.

**Ответ**:
```json
[
  {
    "id": 1,
    "user_1": "user1",
    "user_2": "user2",
    "active": false
  },
  {
    "id": 2,
    "user_1": "user3",
    "user_2": "user2",
    "active": false
  }
]
```

**Ошибки**:
- `404`: Если приглашения не найдены.

---

### 3. **POST `/accept_invitation/{chat_id}`**
**Описание**: Принимает приглашение в чат по его ID и активирует чат.

**Параметры пути**:
- `chat_id` (int): ID чата, который нужно активировать.

**Тело запроса**:
```json
{
  "user_2_secret": "string" // Секретный ключ второго пользователя
}
```

**Ответ**:
```json
{
  "message": "Invitation accepted.",
  "chat": {
    "id": 1,
    "user_1": "user1",
    "user_2": "user2",
    "user_1_secret": "secret1",
    "user_2_secret": "secret2",
    "active": true
  }
}
```

**Ошибки**:
- `404`: Если чат не найден.
- `400`: Если чат уже активен.

---

### 4. **GET `/last_active_chat`**
**Описание**: Возвращает последний активный чат между двумя пользователями.

**Query параметры**:
- `user_1` (str): Имя первого пользователя.
- `user_2` (str): Имя второго пользователя.

**Ответ**:
```json
{
  "id": 5,
  "user_1": "user1",
  "user_2": "user2",
  "user_1_secret": "secret1",
  "user_2_secret": "secret2",
  "active": true
}
```

**Ошибки**:
- `404`: Если активный чат не найден.

---

## Запуск проекта

1. Установите зависимости:
```bash
pip install fastapi sqlalchemy uvicorn
```

2. Запустите сервер разработки:
```bash
uvicorn app.main:app --reload
```

3. Откройте документацию API:
- Swagger UI: `http://127.0.0.1:8000/docs`
- ReDoc: `http://127.0.0.1:8000/redoc`

---

## Пример структуры проекта
```
app/
|-- main.py          # Точка входа приложения
|-- models.py        # SQLAlchemy модели
|-- schemas.py       # Pydantic схемы для запросов и ответов
|-- database.py      # Подключение к базе данных
|-- routers/
    |-- chat.py      # Роутеры для управления чатами
